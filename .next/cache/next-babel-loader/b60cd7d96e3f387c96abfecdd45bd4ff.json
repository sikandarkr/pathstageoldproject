{"ast":null,"code":"import Router from \"next/router\";\nimport axios from \"axios\";\nconst WINDOW_USER_SCRIPT_VARIABLE = \"__USER__\";\nexport const getUserScript = user => {\n  return `${WINDOW_USER_SCRIPT_VARIABLE} = ${JSON.stringify(user)};`;\n};\nexport const getSessionFromServer = req => {\n  if (req.user) {\n    return {\n      user: req.user\n    };\n  }\n\n  return {};\n};\nexport const getSessionFromClient = () => {\n  if (false) {\n    const user = window[WINDOW_USER_SCRIPT_VARIABLE] || {};\n    return {\n      user\n    };\n  }\n\n  return {\n    user: {}\n  };\n};\n\nconst redirectUser = (res, path) => {\n  if (res) {\n    res.redirect(302, path);\n    res.finished = true;\n    return {};\n  }\n\n  Router.replace(path);\n  return {};\n};\n\nexport const authInitialProps = isProtectedRoute => ({\n  req,\n  res,\n  query: {\n    userId\n  }\n}) => {\n  const auth = req ? getSessionFromServer(req) : getSessionFromClient();\n  const currentPath = req ? req.url : window.location.pathname;\n  const user = auth.user;\n  const isAnonymous = !user;\n\n  if (isProtectedRoute && isAnonymous && currentPath !== \"/signin\") {\n    return redirectUser(res, \"/signin\");\n  }\n\n  return {\n    auth,\n    userId\n  };\n};\nexport const signupUser = async user => {\n  const {\n    data\n  } = await axios.post(\"/api/auth/signup\", user); // console.log(\"data returned from the server...\",data)\n\n  return data;\n};\nexport const signinUser = async user => {\n  console.log(\"user details\", user);\n  const {\n    data\n  } = await axios.post(\"/api/auth/signin\", user);\n\n  if (false) {\n    window[WINDOW_USER_SCRIPT_VARIABLE] = data || {};\n  }\n};\nexport const signoutUser = async () => {\n  if (false) {\n    window[WINDOW_USER_SCRIPT_VARIABLE] = {};\n  }\n\n  await axios.get(\"/api/auth/signout\");\n  Router.push(\"/signin\");\n};","map":{"version":3,"sources":["/Users/sikandarkumarkumar/Desktop/Others/exampl/lib/auth.js"],"names":["Router","axios","WINDOW_USER_SCRIPT_VARIABLE","getUserScript","user","JSON","stringify","getSessionFromServer","req","getSessionFromClient","window","redirectUser","res","path","redirect","finished","replace","authInitialProps","isProtectedRoute","query","userId","auth","currentPath","url","location","pathname","isAnonymous","signupUser","data","post","signinUser","console","log","signoutUser","get","push"],"mappings":"AAAA,OAAOA,MAAP,MAAmB,aAAnB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,MAAMC,2BAA2B,GAAG,UAApC;AAEA,OAAO,MAAMC,aAAa,GAAGC,IAAI,IAAI;AACnC,SAAQ,GAAEF,2BAA4B,MAAKG,IAAI,CAACC,SAAL,CAAeF,IAAf,CAAqB,GAAhE;AACD,CAFM;AAIP,OAAO,MAAMG,oBAAoB,GAAGC,GAAG,IAAI;AACzC,MAAIA,GAAG,CAACJ,IAAR,EAAc;AACZ,WAAO;AAAEA,MAAAA,IAAI,EAAEI,GAAG,CAACJ;AAAZ,KAAP;AACD;;AACD,SAAO,EAAP;AACD,CALM;AAOP,OAAO,MAAMK,oBAAoB,GAAG,MAAM;AACxC,aAAmC;AACjC,UAAML,IAAI,GAAGM,MAAM,CAACR,2BAAD,CAAN,IAAuC,EAApD;AACA,WAAO;AAAEE,MAAAA;AAAF,KAAP;AACD;;AACD,SAAO;AAAEA,IAAAA,IAAI,EAAE;AAAR,GAAP;AACD,CANM;;AAQP,MAAMO,YAAY,GAAG,CAACC,GAAD,EAAMC,IAAN,KAAe;AAClC,MAAID,GAAJ,EAAS;AACPA,IAAAA,GAAG,CAACE,QAAJ,CAAa,GAAb,EAAkBD,IAAlB;AACAD,IAAAA,GAAG,CAACG,QAAJ,GAAe,IAAf;AACA,WAAO,EAAP;AACD;;AACDf,EAAAA,MAAM,CAACgB,OAAP,CAAeH,IAAf;AACA,SAAO,EAAP;AACD,CARD;;AAUA,OAAO,MAAMI,gBAAgB,GAAGC,gBAAgB,IAAI,CAAC;AACnDV,EAAAA,GADmD;AAEnDI,EAAAA,GAFmD;AAGnDO,EAAAA,KAAK,EAAE;AAAEC,IAAAA;AAAF;AAH4C,CAAD,KAI9C;AACJ,QAAMC,IAAI,GAAGb,GAAG,GAAGD,oBAAoB,CAACC,GAAD,CAAvB,GAA+BC,oBAAoB,EAAnE;AACA,QAAMa,WAAW,GAAGd,GAAG,GAAGA,GAAG,CAACe,GAAP,GAAab,MAAM,CAACc,QAAP,CAAgBC,QAApD;AACA,QAAMrB,IAAI,GAAGiB,IAAI,CAACjB,IAAlB;AACA,QAAMsB,WAAW,GAAG,CAACtB,IAArB;;AACA,MAAIc,gBAAgB,IAAIQ,WAApB,IAAmCJ,WAAW,KAAK,SAAvD,EAAkE;AAChE,WAAOX,YAAY,CAACC,GAAD,EAAM,SAAN,CAAnB;AACD;;AACD,SAAO;AAAES,IAAAA,IAAF;AAAQD,IAAAA;AAAR,GAAP;AACD,CAbM;AAeP,OAAO,MAAMO,UAAU,GAAG,MAAMvB,IAAN,IAAc;AACtC,QAAM;AAAEwB,IAAAA;AAAF,MAAW,MAAM3B,KAAK,CAAC4B,IAAN,CAAW,kBAAX,EAA+BzB,IAA/B,CAAvB,CADsC,CAEtC;;AACA,SAAOwB,IAAP;AACD,CAJM;AAMP,OAAO,MAAME,UAAU,GAAG,MAAM1B,IAAN,IAAc;AACpC2B,EAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA2B5B,IAA3B;AACF,QAAM;AAAEwB,IAAAA;AAAF,MAAW,MAAM3B,KAAK,CAAC4B,IAAN,CAAW,kBAAX,EAA+BzB,IAA/B,CAAvB;;AACA,aAAmC;AACjCM,IAAAA,MAAM,CAACR,2BAAD,CAAN,GAAsC0B,IAAI,IAAI,EAA9C;AACD;AACF,CANM;AAQP,OAAO,MAAMK,WAAW,GAAG,YAAY;AACrC,aAAmC;AACjCvB,IAAAA,MAAM,CAACR,2BAAD,CAAN,GAAsC,EAAtC;AACD;;AACD,QAAMD,KAAK,CAACiC,GAAN,CAAU,mBAAV,CAAN;AACAlC,EAAAA,MAAM,CAACmC,IAAP,CAAY,SAAZ;AACD,CANM","sourcesContent":["import Router from \"next/router\";\nimport axios from \"axios\";\n\nconst WINDOW_USER_SCRIPT_VARIABLE = \"__USER__\";\n\nexport const getUserScript = user => {\n  return `${WINDOW_USER_SCRIPT_VARIABLE} = ${JSON.stringify(user)};`;\n};\n\nexport const getSessionFromServer = req => {\n  if (req.user) {\n    return { user: req.user };\n  }\n  return {};\n};\n\nexport const getSessionFromClient = () => {\n  if (typeof window !== \"undefined\") {\n    const user = window[WINDOW_USER_SCRIPT_VARIABLE] || {};\n    return { user };\n  }\n  return { user: {} };\n};\n\nconst redirectUser = (res, path) => {\n  if (res) {\n    res.redirect(302, path);\n    res.finished = true;\n    return {};\n  }\n  Router.replace(path);\n  return {};\n};\n\nexport const authInitialProps = isProtectedRoute => ({\n  req,\n  res,\n  query: { userId }\n}) => {\n  const auth = req ? getSessionFromServer(req) : getSessionFromClient();\n  const currentPath = req ? req.url : window.location.pathname;\n  const user = auth.user;\n  const isAnonymous = !user;\n  if (isProtectedRoute && isAnonymous && currentPath !== \"/signin\") {\n    return redirectUser(res, \"/signin\");\n  }\n  return { auth, userId };\n};\n\nexport const signupUser = async user => {\n  const { data } = await axios.post(\"/api/auth/signup\", user);\n  // console.log(\"data returned from the server...\",data)\n  return data;\n};\n\nexport const signinUser = async user => {\n    console.log(\"user details\",user)\n  const { data } = await axios.post(\"/api/auth/signin\", user);\n  if (typeof window !== \"undefined\") {\n    window[WINDOW_USER_SCRIPT_VARIABLE] = data || {};\n  }\n};\n\nexport const signoutUser = async () => {\n  if (typeof window !== \"undefined\") {\n    window[WINDOW_USER_SCRIPT_VARIABLE] = {};\n  }\n  await axios.get(\"/api/auth/signout\");\n  Router.push(\"/signin\");\n};\n"]},"metadata":{},"sourceType":"module"}